{% extends "base/base.html" %}
{% block title %}Support Tickets â€” Deliver{% endblock %}
{% block navbar %}{% if request.user.role == 'driver' %}{% include "base/sidebar_driver.html" %}{% else %}{% include "base/sidebar_customer.html" %}{% endif %}{% endblock %}
{% block content %}
<div class="topbar"><span class="topbar-title"><i class="fa fa-headset me-2" style="color:var(--primary-light)"></i>My
        Tickets</span>
    <div class="topbar-user"><a href="{% url 'raise_ticket' %}" class="btn btn-primary btn-sm"><i
                class="fa fa-plus me-1"></i>Raise Ticket</a></div>
</div>
<div class="container-fluid py-4">
    <div class="deliver-table">
        <table class="table table-dark table-hover mb-0">
            <thead>
                <tr>
                    <th>Ticket ID</th>
                    <th>Subject</th>
                    <th>Priority</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Response</th>
                </tr>
            </thead>
            <tbody>
                {% for t in tickets %}
                <tr>
                    <td><span style="color:var(--primary-light)">{{ t.ticket_id }}</span></td>
                    <td>{{ t.subject }}</td>
                    <td><span class="badge bg-secondary">{{ t.get_priority_display }}</span></td>
                    <td><span class="status-badge status-{{ t.status }}">{{ t.get_status_display }}</span></td>
                    <td class="small text-muted">{{ t.created_at|date:"d M Y" }}</td>
                    <td class="small">{{ t.admin_response|default:"Awaiting response"|truncatechars:40 }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center py-4 text-muted">No tickets raised yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}